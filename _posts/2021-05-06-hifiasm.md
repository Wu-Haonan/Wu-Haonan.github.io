---
layout: article
title: <font size=6> 文献分享：Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm </font>
tags: TeXt
article_header:
  type: cover
  image: 
    src: /post_image/hifiasm/hifiasm.PNG
---

# 写在前面
今天给大家分享的这篇文章hifiasm是2021年2月份哈佛的Heng Li发在Nature methods上的一篇关于基因组拼接的新作，Heng Li是生物信息算法这方面的大佬了，BEA-MEM,minimap2,wtdbg2等等，做了很多序列比对、拼接方面的优秀算法。今天这篇是，单倍型分辨率的从头拼接算法。先做一个简单的介绍，所谓的Haplotype-resolved和phased assembly是一个意思（见Heng Li去年的一篇nature biotech的摘要[Chromosome-scale, haplotype-resolved assembly of human genomes](https://www.nature.com/articles/s41587-020-0711-0)），指的就是我们能够重构出多倍体物种的所有的单倍型。就人类的基因组而言，对于每对同源染色体其实我们有父源和母源两条，上面可能携带了不同的等位基因，但是传统的assembly方法都忽略了两条染色体的差异，其实最后生成的contigs是类似consensus的sequence。其中的原因也比较显然，因为我们测序的时候将所有基因组随即打碎，我们也分辨不出父源母源的序列。如下图，一般我们称左边得到的concensus序列叫做Genotype,而我们的目标是phase出来父源母源两条序列。那么将一堆等位基因都分别还原出来，对于遗传、各种疾病检测的意义肯定是不言而喻的。
![传统拼接的consensus序列 VS phased序列](/post_image/hifiasm/phased_seq.png)

<center> 传统拼接的consensus序列 Vs phased序列 </center>

那么，我们有什么手段可以进行phasing呢？

1.首先，最直接的方法，我们可以再测该个体的母亲和父亲的基因组，当然这个方法缺点就在于我们又多测了两个基因组，有时候我们可能都得不到父母的基因组，其次，如果父母都是杂合子AB，那么我们也不能判断出来子代等位基因AB的来源；在2018年，National Institutes of Health (NIH) and the United States Department of Agriculture (USDA)的两个科学家在nature biotech上发布了Trio binning算法（Trio指的就是Father-mather-child三样本），我们可以看一些Heng Li在20年7月发的一篇natrue biotech对trio binning的评价
>
*FALCON-Phase, which extends FALCON-Unzip, ...... but it cannot achieve chromosome-long phasing. Trio binning is the only published method that can do this, plus the assembly and phasing of entire chromosomes. ...... However, trio binning is unable to resolve regions heterozygous in all three samples in the trio and will leave such regions unphased. More importantly, parental samples are not always available—for example, for samples caught in the wild or when parents are deceased. For Mendelian diseases, de novo mutations in the offspring will not be captured and phased with the parents if there are no other heterozygotes nearby. This limits the application of trio binning.*
>
下面是trio binning的一个workflow，
![Outline of trio binning and haplotype assembly](/post_image/hifiasm/trio_binning.PNG)

Outline of trio binning and haplotype assembly[^1]
[^1]:图片来源：https://www.nature.com/articles/nbt.4277

2.第二种是LD phase，也就是根据连锁不平衡，有些区域的染色体在减数分裂同源染色体重组的时候，更不容易重组，经常连锁在一起，我们也可以构建一些遗传的统计模型，HMM模型来预测我们所测样本的可能单倍型，这个涉及遗传的知识比较多，就不再详述，当然了问题也很多，LD方法对于罕见突变或者个体特有的突变完全无能为力；
3.Physical phase，也就是我们不依赖任何外部的信息，就从该个体的基因组测序结果进行重构，因为从本质上，每一个read一定来自同一个单倍型，所以其实就是一个局部的phase，然后我们的目标是将这些局部的phase延伸成尽可能长的单倍型序列，所以我们最终目标是，将整个姐妹染色单体分别重构，或者说我们想得到telomere-to-telomere的phase。这也是我们这篇文章所做的phasing算法就属于这个方法。

# Background
然后我们先来看两个概念，这两个概念的名词解释来自于前几天Heng Li自己发的Blog [Heng Li的博客](https://lh3.github.io/2021/04/17/concepts-in-phased-assemblies)

**Haplotig**: a contig that comes from the same haplotype. In an unphased assembly, a contig may join alleles from different parental haplotypes in a diploid or polyploid genome.

**Haplotype-resolved assembly**: sets of (haploid) complete assemblies consisting of haplotigs, representing an entire diploid/polyploid genome. This concept has been inconsistently used in publications without a clear definition. The above is my take in our recent papers.

也就是Haplotig表示序列来自同一单倍型的contig，而Haplotype-resolved assembly表示一些(haploid) complete assemblies的集合，也就是这些组装（由haplotigs构成）共同代表了整个二（多）倍体基因组。

# Introduction

# Method

# Result
