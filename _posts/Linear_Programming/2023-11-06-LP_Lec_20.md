---
layout: article
title: Lecture 20:Duality--Duality Theory
tags: Linear_Programming
aside:
  toc: true
sidebar:
  nav: Linear_Programming
---

In this blog, we try to find the relation between primal and dual problems. In specific, we will introduce two theorems -- **Weak Duality** and **Strong Duality**. 

<!--more-->

# Preparation

Recall the **Relations between primal and dual variables and constraints**

|   Primal    |              $\min \quad \bar{c}^\top \bar{x}$               |              $\max \quad \bar{p}^\top \bar{b}$               |    Dual     |
| :---------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :---------: |
| Constraints | $ \begin{aligned} \bar{a}_i^\top \bar{x} & \geq b_i \\ \bar{a}_i^\top \bar{x} & \leq b_i \\ \bar{a}_i^\top \bar{x} & = b_i \end{aligned} $ | $\begin{aligned} p_i & \geq 0 \\ p_i & \leq 0 \\ p_i &\text{ free}   \end{aligned}$ |  Variables  |
|  Variables  | $\begin{aligned} x_j & \geq 0 \\ x_j & \leq 0 \\ x_j &\text{ free}   \end{aligned}$ | $\begin{aligned} \bar{p}^\top \bar{A}_j & \leq c_j \\ \bar{p}^\top \bar{A}_j & \geq c_j \\ \bar{p}^\top \bar{A}_j & = c_j \end{aligned} $ | Constraints |

Let's change the form in following way

|   Primal    |              $\min \quad \bar{c}^\top \bar{x}$               |              $\max \quad \bar{p}^\top \bar{b}$               |    Dual     |
| :---------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :---------: |
| Constraints | $ \begin{aligned} \bar{a}_i^\top \bar{x} -b_j & \geq 0 \\ \bar{a}_i^\top \bar{x} - b_j & \leq 0 \\ \bar{a}_i^\top \bar{x} - b_j & = 0 \end{aligned} $ | $\begin{aligned} p_i & \geq 0 \\ p_i & \leq 0 \\ p_i &\text{ free}   \end{aligned}$ |  Variables  |
|  Variables  | $\begin{aligned} x_j & \geq 0 \\ x_j & \leq 0 \\ x_j &\text{ free}   \end{aligned}$ | $\begin{aligned} c_j - \bar{p}^\top \bar{A}_j & \geq 0 \\ c_j - \bar{p}^\top \bar{A}_j & \leq 0 \\ c_j -\bar{p}^\top \bar{A}_j & = 0 \end{aligned} $ | Constraints |

# Weak Duality

**Theorem: ** Weak Duality. Given a primal/dual pair of LP problems, If $\bar{x}$ is a **feasible solution** of the primal problem (min problem) and $\bar{p}$ is a **feasible solution** of the dual problem (max problem), then $\bar{p}^\top \bar{b} \leq \bar{c}^\top \bar{x}$.

**Proof:** Given $\bar{x}$ primal feasible and $\bar{p}$ dual feasible, we have:

1. $\bar{a}_i^\top \bar{x} - b_i$, and $\bar{p}_i$ have the same sign
2. $\bar{x}_j$ and $(c_j - \bar{p}^\top \bar{A}_j)$ have the same sign

This leads to the inequalities:

- $\bar{p}_i (\bar{a}_i^\top \bar{x} - b_i) \geq 0$ for $i=1,\ldots,m$
- $(c_j - \bar{p}^\top \bar{A}_j)\bar{x}_j \geq 0$ for $j=1,\ldots,n$

Summing these up, we get:

$$
\bar{p}^\top (A\bar{x} - \bar{b}) = \sum_{i=1}^m \bar{p}_i (\bar{a}_i^\top \bar{x} - b_i) \geq 0
$$

and

$$
(\bar{c}^\top - \bar{p}^\top A)\bar{x} = \sum_{j=1}^n (c_j - \bar{p}^\top \bar{A}_j)\bar{x}_j \geq 0
$$

It follows that $\bar{c}^\top \bar{x} - \bar{p}^\top \bar{b} = (\bar{c}^\top - \bar{p}^\top A)\bar{x} + \bar{p}^\top (A\bar{x} - \bar{b}) \geq 0$. $\square$



**Corollary 1**

(a) If the optimal cost in the primal problem is $-\infty$, then the dual problem must be infeasible.

(b) If the optimal cost in the dual problem is $+\infty$, then the primal problem must be infeasible.

**Proof.** Denote the Polyhedra of Primal and dual problems is $P$ and $D$.

(a) Suppose that the optimal cost in the primal problem is $-\infty$ and that the dual problem has a **feasible solution** $\bar{p}$. By weak duality,

$$
\bar{p}^\top \bar{b} \leq \bar{c}^\top \bar{x} \quad \forall \bar{x} \in P.
$$

We know $\bar{p}^\top \bar{b}$ is a finite number. But ${ \bar{p}^\top \bar{b} \leq \min \\{\bar{c}^\top \bar{x} \mid \bar{x} \in P \\}}$, which 
contradicts to that optimal cost of the primal problem is $-\infty$. Therefore the dual problem cannot have a feasible solution if the optimal cost for the primal is $-\infty$.

(b) Suppose that the optimal cost in the dual problem is $+\infty$ and that the primal problem has a feasible solution $\bar{x}$. By weak duality,

$$
\bar{p}^\top \bar{b} \leq \bar{c}^\top \bar{x} \quad \forall \bar{p} \in D.
$$

We know $\bar{c}^\top \bar{x}$ is a finite number. But ${ \max \\{\bar{p}^\top \bar{b} \mid \bar{p}\in D\\} \leq \bar{c}^\top \bar{x}}$, which contradicts to the optimal cost in the dual problem is $+\infty$. Therefore the primal problem cannot have a feasible solution if the optimal cost for the dual is $+\infty$. $\square$

**Corollary 2** Given a primal/dual pair of LP problems
$$
\begin{aligned}
\text{minimize} \quad & \bar{c}^\top \bar{x} \\
\text{subject to} \quad & \text{...}
\end{aligned}
$$
and
$$
\begin{aligned}
\text{maximize} \quad & \bar{p}^\top \bar{b} \\
\text{subject to} \quad & \text{...}
\end{aligned}
$$

If $\bar{x}$ is a **feasible solution** of the primal problem, $\bar{p}$ is a **feasible solution** of the dual problem, and <font color=red>$\bar{p}^\top \bar{b} = \bar{c}^\top \bar{x}$ </font>, then $\bar{x}$ is an **optimal solution** of the primal problem and $\bar{p}$ is an **optimal solution** of the dual problem.

**Proof:**
Since $\bar{p}$ is a feasible solution of the dual problem, the weak duality theorem tell us that

$$
\bar{p}^\top \bar{b} \leq \bar{c}^\top \bar{y}, \forall \bar{y} \in P
$$

And $\bar{p}^\top \bar{b} = \bar{c}^\top \bar{x}$, we have

$$
\bar{c}^\top \bar{x} \leq \bar{c}^\top \bar{y}, \forall \bar{y} \in P
$$

By assumption, we know $\bar{x}$ is a feasible solution of primal problem. Hence $\bar{x}$ is an optimal solution of the primal problem.

On the other hand, since $\bar{x}$ is a feasible solution of the primal problem, the weak duality theorem asserts that

$$
\bar{q}^\top \bar{b} \leq \bar{c}^\top \bar{x}, \forall \bar{q} \in D
$$

Since $\bar{p}^\top \bar{b} = \bar{c}^\top \bar{x}$, it follows that $\bar{q}^\top \bar{b} \leq \bar{p}^\top \bar{b}, \forall  \bar{q} \in D. $ And $\bar{p}$ is feasible solution of dual problem. Hence, $\bar{p}$ is an optimal solution of the dual problem. $\square$



**Note:** The corollary 2 tells us if we can find  pair feasible solutions $\bar{x},\bar{p}$ in primal and dual problems, then we know they are both optimal solution in each problem, which give us an inspiration that the **optimal costs of primal and dual problem are equal**. The above idea lead to following theorem -- **Strong Duality**. In this proof, the key step is to construct a pair of feasible solutions such that <font color=red>$\bar{p}^\top \bar{b} = \bar{c}^\top \bar{x}$ </font>.

# Strong Duality

### Theorem 4.4 (Strong Duality)
If a LP problem admits an optimal solution, so does its dual, and the respective (primal and dual) optimal costs are equal.

**Proof.**

First, we consider the **primal problem in standard form**, and then generalize this conclusion.

Consider the standard form primal problem:

$$
\begin{aligned}
\text{minimize} \quad & \bar{c}^\top \bar{x} \\
\text{subject to} \quad & A\bar{x} = \bar{b} \\
& \bar{x} \geq \bar{0}
\end{aligned}
$$

and its dual problem:

$$
\begin{aligned}
\text{maximize} \quad & \bar{p}^\top \bar{b} \\
\text{subject to} \quad & \bar{p}^\top A \leq \bar{c}^\top.
\end{aligned}
$$

Assume (temporarily) that the rows of $A$ are linearly independent and that there exists an optimal solution to the primal problem. The simplex algorithm applied to the primal problem will terminate with an optimal basis $B$. The vector of basic variables of the corresponding optimal (primal) basic feasible solution $\bar{x}$ is $B^{-1}\bar{b}$. At $\bar{x}$. where the simplex algorithm terminates, the reduced costs must be nonnegative:

$$
\bar{c}^\top - \bar{c}_B^\top B^{-1}\bar{A} \geq \bar{0}^\top
$$

Set $\bar{p} = \bar{c}_B^\top B^{-1}$. Then $ \bar{p}^\top A = \bar{c}_B^\top B^{-1} A \leq \bar{c}^\top$, which shows that $\bar{p}$ is a feasible solution of the dual problem. Furthermore, we have

$$
\bar{p}^\top \bar{b} = \bar{c}_B^\top B^{-1}\bar{b} = \bar{c}_B^\top \bar{x}_B= \bar{c}^\top \bar{x}
$$

Since the dual cost at the dual feasible solution $\bar{p}$ is equal to the primal cost at the primal optimal solution $\bar{x}$, **Corollary 2** asserts that $\bar{p}$ is an optimal solution to the dual problem. Hence the dual optimal cost $\bar{p}^\top \bar{b}$ is equal to the primal optimal cost $\bar{c}^\top \bar{x}$. 

Now let's consider the **general cases**, by [theorem](https://wu-haonan.github.io/2023/11/03/LP_Lec_19.html#dual-of-equivalent-problems-are-equivalent), we know dual problems of equivalent problems are equivalent. We can reformulate any LP problem $\Pi$ into standard form $\Phi$. So, we know optimal costs of problem $\Pi$ and $\Phi$ are equal. And we know optimal costs are equal in dual and primal problem in standard form case. Hence, we know the optima costs of $Pi$ and its dual problem are equal. $\square$



# Relations between Primal and Dual

The table below illustrates the relationships between the primal and dual problems:

|      PRIMAL \ DUAL       | Optimal Cost is $+\infty$ | Finite Optimal Cost |    Infeasible    |
| Optimal Cost is $-\infty$ |   X   |            X             |        ✓        |
| Finite Optimal Cost |           X            |            ✓             |        X         |
|        Infeasible        |           ✓           |            X             | ✓ |

- A checkmark (✓) denotes a possible scenario.
- A cross (X) indicates an impossible scenario.

The checkmarks represent the cases where the duality theorems hold true, according to the theorems stated in the text above the table. The cross marks indicate cases that are not possible due to the duality properties of linear programming problems.



**Later: geometric proof not based on the simplex algorithm.**

