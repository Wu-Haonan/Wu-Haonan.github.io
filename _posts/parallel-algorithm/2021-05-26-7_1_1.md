---
layout: article
title: 7.1.1 无约束问题的并行变量分配算法
aside:
  toc: true
sidebar:
  nav: parallel_algorithm
---
在这一节我们介绍PVD(**P**arallel **V**ariable **D**istribution)算法，也就是所谓的并行变量分配算法

考虑如下的无约束非线性优化问题：

$$\min_{x\in \mathbb{R}^{n}} f(x) \tag{7.1.1}$$

其中$f(x):\mathbb{R}^{n}\rightarrow \mathbb{R}^{1}$为连续可微函数。

# PVD算法概要

假设可以同时使用 $p$ 个处理机，将问题的变量 $x\in \mathbb{R}^{n}$ 分成 $p$ 块 $x_{1},x_{2},\ldots,x_{p}$ ，第 $l$ 块的变量维数为 $n_{l}$ ，同时 $x$ 的分块满足

$$ x=(x^{T}_{1},\ldots,x^{T}_{p})^{T}, x\in \mathbb{R}^{n_{l}}, l=1,2,\ldots,p, \sum_{l=1}^{p} n_{l} = n. \notag$$

将这 $p$ 块变量分配到 $p$ 个处理机上，在每一步根据分块的方式将原问题相地分解为维数较小的 $p$ 个子问题上，每个处理机不仅仅计算自己负责变量的更新，同时沿着给定的方向（每次并行计算之前都要提前给定方向），更新其余处理机对应变量的移动步长，这个称之为"Forget me not"（勿忘我），*个人理解：每个处理机不只是更新自己的那部分变量*，然后选择 $p$ 个处理机得到的结果中最优的一个作为变量的下一次迭代值 $x^{(i+1)}$.

# PVD算法的计算步骤

**步骤 $0$** 给定初始点 $x^{0}\in \mathbb{R}^{n}$，任取PVD方向 $\boldsymbol{d}^0\in \mathbb{R}^{n}$ （可以任意选取，如取 $\boldsymbol{d}^{i}=-\nabla f(x^{(i)})/\Vert \nabla f(x^{(i)}) \Vert$ ）.令 $i=0$.若 $\nabla f(x^{(i)}) = \mathbf{0}$.取最优解 $\boldsymbol{x}^{*} = \boldsymbol{x}^{(i)}$ ，算法停止；否则按照如下步骤计算 $\boldsymbol{x}^{(i+1)}$ .

**步骤 $1$** （并行计算） 对每个处理机 $l\in \\{1,2,\ldots,p\\}$ ，计算下面问题的一个近似解 $( \boldsymbol{y}_ {l}^{i},\boldsymbol{\lambda}_ {\bar{l}}^{i} ) \in \mathbb{R}^{n_{l}} \times \mathbb{R}^{p-1}$ :

$$
\begin{aligned}
\min_{(\boldsymbol{x}_l,\boldsymbol{\lambda}_{\bar{l}})} \psi_{l}^{i} (\boldsymbol{x}_{l},\boldsymbol{\lambda}_{\bar{l}}) &= f(\boldsymbol{x}_{l},\boldsymbol{x}_{\bar{l}}^{(i)} + \boldsymbol{D}_{\bar{l}}^{i}\boldsymbol{\lambda}_{\bar{l}}), \\
\boldsymbol{x}^{i_{l}} &= (\boldsymbol{y}_{l}^{i},\boldsymbol{x}_{\bar{l}}^{(i)} + \boldsymbol{D}_{\bar{l}}^{i}\boldsymbol{\lambda}_{\bar{l}}^{i}).
\end{aligned} \tag{7.1.2}
$$

**步骤 $2$** （同步运算） 计算 $x^{(i+1)}$ ，使其满足下面不等式

$$f(\boldsymbol{x}^{(i+1)}) \leq \min_{l\in \{1,2,\ldots,p\}} f(\boldsymbol{x}^{i_{l}}) = \psi_{l}^{i} (\boldsymbol{y}_ {l}^{i},\boldsymbol{\lambda}_ {\bar{l}}^{i})  \tag{7.1.3}$$

令 $i = i + 1$ ，选取新的方向 $d^{i}$; 重复上述步骤. 

上述算法中, $\bar{l}$ 表示 $l$ 在集合 $\\{1,2,\ldots,p\\}$ 中的补集, $D^i_{\bar{l}}$ 为 $(n - n_l)\times(p-1)$ 矩阵,其由相应的PVD方向 $d^i$ (除了第 $l$ 块变量外) 放在矩阵的对角线位置而构成,如下所示

$$
\boldsymbol{D}^i_l = 
\begin{bmatrix}
    d^i_1 & & & & & & \\
    & d^i_2 & & & & &\\
    & &\ddots & & & &\\
    & & &d^i_{i-1} & & &\\
    & & & &d^i_{i+1} & &\\
    & & & & &\ddots &\\
    & & & & & &d^i_p
\end{bmatrix}. \tag{7.1.4}
$$

我们通过下面是示意图来理解一下PVD算法做了什么，着重注意步骤 $1$，其实处理器 $l$ 在第 $i$ 次迭代，做了件什么事情呢，就是寻找将 ${x^{(i)}_ l}$ 进行改变，其他处理器对应的变量寻找一个系数 ${\lambda}$ 乘上去。所以，针对这 ${p-1}$ 维的 ${\lambda_{\bar{l}}}$ 和 ${n_l}$ 维的 ${x_l}$ 求最小值。

![PVD流程](/post_image/parallel-algorithm/PVD流程.png)

# PVD算法的收敛性

下面来讨论一下一下PVD算法的收敛性。首先声明一些记号，对于连续可微的函数 $f:\mathbb{R}^n\rightarrow \mathbb{R}^1$，我们用 $\nabla f$ 来表示 $f$ 的梯度，所谓的梯度是对自变量的 $x$ 的每个分量求偏导，这里用 $\nabla_l f$ 表示 $f$ 关于 $\boldsymbol{x}_l \in \mathbb{R}^{n_l}. l = 1,2,\ldots,p$ 的梯度. 如果 $f$ 在 $\mathbb{R}^n$ 上有连续的一阶偏导数，则记为 ${f\in C^1(\mathbb{R}^n)}$. 如果 ${f}$ 在 ${\mathbb{R}^n}$ 上有常数为 ${K}$ 的  Lipschitz 连续一阶偏导数.即

<center>$$
\Vert \nabla f(y)-\nabla f(x)\Vert \leq K\Vert y-x\Vert,\quad \forall x,y\in \mathbb{R}^n. \notag
$$</center> 

则记为 ${f\in LC^1_K(\mathbb{R}^n)}$.

<details><summary> <b>引理 7.1.1</b> 如果实数序列 $\{f_i\}$ 不增且有聚点 $\bar{f}$,则 $\{f_i\}$ 收敛到 $\bar{f}$. </summary>
证明 首先证明序列 $\{f_i\}$ 下方有界.设 $f_{i_j} \rightarrow \bar{f}$. 若 $\{f_i\}$ 下方无界，则存在 $i,j$ 满足
  $$\bar{f} > f_i （因为\{f_i\}是下方无界的），\notag$$
  $$f_i \geq f_{i_j} （因为\{f_i\}是非增序列），\notag$$
  $$f_{i_j} \geq \bar{f} （因为\{f_{i_j}\}非增加且收敛到\bar{f}）.\notag$$
  矛盾！因此 $\{f_i\}$ 是下方有界的，其又非增，所以一定收敛，且一定收敛到 $\bar{f}$. $\Box$
</details>

<details><summary> <b>引理 7.1.2</b> 设 $f\in LC^1_k(\mathbb{R}^n)$,则
$$f(y)-f(x)-\nabla f(x)^T (y-x) \leq |f(y)-f(x)-\nabla f(x)^T (y-x)|\leq \frac{K}{2} {\Vert y-x \Vert}^2.\quad \forall x,y\in \mathbb{R}^n.\notag$$ </summary>
书上没有写,我也不会证!
</details>

<details><summary> <b>定理7.1.1</b>（无约束PVD算法的收敛性） 设 ${f\in LC^1_K(\mathbb{R}^n)}$，序列 ${\{\boldsymbol{d}^i\}}$ 有界. 则算法产生的序列 ${\{\boldsymbol{x}^{(i)}\}}$ 或者终止于一个稳定点 ${\boldsymbol{x}^i}$，或者为无限序列，其聚点是 ${f}$ 的稳定点且 ${\lim\limits_{i\rightarrow \infty} \nabla f(\boldsymbol{x}^{(i)}) = \mathbf{0}}$</summary>
证明 对 ${l=1,\ldots,p}$，对 ${\psi_l^i}$ 求梯度，有

<details><summary> $$\nabla \psi^i_l (\boldsymbol{x}_l,\boldsymbol{\lambda}_{\bar{l}}) = [\nabla_l f(\boldsymbol{x}_{l},\boldsymbol{x}_{\bar{l}}^{(i)} + \boldsymbol{D}_{\bar{l}}^{i}\boldsymbol{\lambda}_{\bar{l}}),\nabla_l f(\boldsymbol{x}_{l},\boldsymbol{x}_{\bar{l}}^{(i)} + \boldsymbol{D}_{\bar{l}}^{i}\boldsymbol{\lambda}_{\bar{l}})\boldsymbol{D}_{\bar{l}}^{i}]. \tag{7.1.5} $$</summary>
我们设 ${w=(x_l,\lambda_{\bar{l}})}$，定义 ${n\times(n_l+p-1)}$ 维矩阵 ${E^i_l}$ 为
$$
E^i_l = 
\begin{bmatrix}
    d^i_1 & & & & & & &\\
    &d^i_2 & & & & & &\\
    & &\ddots & & & & &\\
    & & &d^i_{i-1} & & & &\\
    & & & &\boldsymbol{I}_{n_l} & & &\\
    & & & & &d^i_{i+1} & &\\
    & & & & & &\ddots &\\
    & & & & & & &d^i_p
\end{bmatrix}.
$$
并记 ${{x'}^{(i)}_{l} \triangleq (\mathbf{0}_{n_l},x^{(i)}_{\bar{l}})}$
</details>

因为 ${f}$ 的梯度是 Lipschitz 连续，又 ${\{\boldsymbol{d}^i\}}$ 有界，故 ${\psi_l^i}$ 也是 Lipschitz 连续的.
    
现在
</details>


