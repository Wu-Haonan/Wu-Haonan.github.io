---
layout: article
title: Randomized Algs:Randomized Selection
tags: Algorithm_Design_and_Analysis
aside:
  toc: true
sidebar:
  nav: Algorithm_Design_and_Analysis

---

This blog, we still talk about randomized algorithms. Today we will focus on Randomized Selection Problem.

<!--more-->

# Selection Problem and LazySelect Algorithm

Given unsorted list $S$ with $n = |S|$ distinct elements, and ${k \in \\{1, \ldots, n\\}}$, find ${S_{(k)}}$, which is the $k$th element of S in sorted order.

For $y \in S$, let $r_S(y) := \vert \{y' \in S | y' \leq y\} \vert$ be the **rank** of $y$ in $S$. The equivalent goal is to find $y \in S$ such that $r_S(y) = k$.

Observe that $r_S(S_{(k)}) = k$ and $S_{r_S(y)} = y$. (Because, all the elements are distinct).

```pseudocode
1: function LAZYSELECT(S, k)
2:   repeat
3:     R ← random ${n^{3/4}}$ elements from S, picked uniformly at random with replacement.
4:     Sort R in $O(|R| \log |R|)$ steps.
5:     x ← $k - n^{1/4}$, a ← $x - \sqrt{n} + 1$, b ← $x + R_{(0)}$.
6:     By comparing a and b to every $s \in S$, find $r_S(a)$ and $r_S(b)$.
7:     $P \leftarrow \begin{cases}
       \{y \in S | y \leq b\} & \text{if } k < n^{3/4} \\
       \{y \in S | a \leq y \leq b\} & \text{if } k \in [n^{3/4}, n - n^{3/4}] \\
       \{y \in S | a \leq y\} & \text{if } k > n - n^{3/4}
       \end{cases}$
8:   until $S(k) \in P$ and $|P| < 4n^{3/4} + 2$
9:   Sort P in $O(|P| \log |P|)$ steps.
10:  return $P_{(k-r_S(a)+1)}$  ⟶ This is $S(k)$.
```



{% highlight pseudocode linenos %}

1: function LAZYSELECT(S, k) 

2:   repeat 

3:     R ← random ${n^{3/4}}$ elements from S, picked uniformly at random with replacement. 

4:     Sort R in $O(|R| \log |R|)$ steps. 

5:     x ← $k - n^{1/4}$, a ← $x - \sqrt{n} + 1$, b ← $x + R_{(0)}$. 

6:     By comparing a and b to every $s \in S$, find $r_S(a)$ and $r_S(b)$. 

7:     $P \leftarrow \begin{cases}       \{y \in S | y \leq b\} & \text{if } k < n^{3/4} \\       \{y \in S | a \leq y \leq b\} & \text{if } k \in [n^{3/4}, n - n^{3/4}] \\       \{y \in S | a \leq y\} & \text{if } k > n - n^{3/4}       \end{cases}$ 

8:   until $S(k) \in P$ and $|P| < 4n^{3/4} + 2$ 

9:   Sort P in $O(|P| \log |P|)$ steps. 10:  return $P_{(k-r_S(a)+1)}$  ⟶ This is $S(k)$.
{% endhighlight %}