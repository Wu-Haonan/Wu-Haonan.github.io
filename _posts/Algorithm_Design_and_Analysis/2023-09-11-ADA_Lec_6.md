---
layout: article
title: Polynomial time Algorithm to Max flow problem
tags: Algorithm_Design_and_Analysis
aside:
  toc: true
sidebar:
  nav: Algorithm_Design_and_Analysis
---

This blog talks about a polynomial time algorithm to Max flow problem, called ${ \Delta }$-Ford-Fulkerson Algorithm.

<!--more-->

# Idea

Our plain idea is find an augmenting path with highest bottleneck capacity in each iteration. However, we can do it in a more efficient way. In each iteration, we augment the path which bottleneck is greater than the threshold $\Delta$. 

Consider the Ford-Fulkerson Algorithm, it's a pseudo-polynomial algorithm because $C$ (the maximum capacity) is annoying. We know the input is $\mathcal{O}(m \lg C )$. So, we hope we can change the factor in running time from $C$ to $\lg C$. Hence, we have following algorithm.

# ${ \Delta }$-Ford-Fulkerson Algorithm

## Pseudocode

{% highlight pseudocode linenos %}
Param-Ford-Fulkerson(G,s,t,C)
	for each e in E
		f(e) = 0 

​	C = max capacity

​	Δ = 2^([lg C]+1) // smallest power of 2 that greater than C

​	G_f = Residual(G,f)

​	while (Δ >= 1)

​		G_f(Δ) :=  subset of the G_f consisting only of edges with edges with residual capacities at least Δ.

​		while (there exists an augmenting path P in G_f(Δ))

​			f' = Augment(f,c, P,Δ)

​			update G_f'

​		Δ = Δ/2

{% endhighlight %}

## Correctness

## Running time 

Assumption:

1. All capacities are integers and each capacity equals and less than ${ C }$.

2. Every flow value ${ f(e) }$ are integers.

<b>Lemma 1</b>: The number of loops is ${ 1+ \lceil \lg C \rceil }$

<b>Lemma 2</b>: Let ${ f }$ be the flow at the end of some ${ \Delta }$ phase. Then if ${ f_{max} }$ be the max flow then

<center>$$
v(f_{max}) \leq v(f) + m \Delta
$$</center>

Proof.

We will show in ${ \Delta }$ phase, ${ \exists }$ cut ${ (A,B) }$ s.t.

<center>$$
Cap(A,B) \leq v(f) + m \Delta
$$</center>

Now we construct cut ${ (A,B) }$ as follow:

<b>Lemma 3</b>: There are at most ${ 2m }$ augmentations in each iteration.